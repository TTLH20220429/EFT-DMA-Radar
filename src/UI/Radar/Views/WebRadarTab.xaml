<UserControl x:Class="LoneEftDmaRadar.UI.Radar.Views.WebRadarTab"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="clr-namespace:LoneEftDmaRadar.UI.Radar.ViewModels"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:local="clr-namespace:LoneEftDmaRadar.UI.Radar.Views"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d"
             Padding="10">

    <d:UserControl.DataContext>
        <d:DesignInstance Type="{x:Type vm:WebRadarViewModel}"
                          IsDesignTimeCreatable="False" />
    </d:UserControl.DataContext>

    <ScrollViewer VerticalScrollBarVisibility="Auto">
        <StackPanel Orientation="Vertical"
                    Margin="0,0,0,10">

            <!-- Web Radar Server -->
            <GroupBox Header="网页雷达服务器"
                      Margin="0,0,0,12">
                <StackPanel>

                    <!-- Controls row  -->
                    <WrapPanel Margin="0,8,0,8">

                        <!-- Start -->
                        <Button Content="{Binding StartButtonText}"
                                IsEnabled="{Binding UiEnabled}"
                                ToolTip="启动嵌入式Web服务器"
                                Command="{Binding StartServerCommand}"
                                MinWidth="80"
                                Height="35"
                                Margin="8,0,12,8" />

                        <!-- UPnP -->
                        <CheckBox Content="UPnP"
                                  IsEnabled="{Binding UiEnabled}"
                                  ToolTip="通过UPnP自动在路由器上开放端口（如支持）"
                                  IsChecked="{Binding UpnpEnabled, Mode=TwoWay}"
                                  Margin="0,0,16,8" />

                        <!-- Bind IP/Host -->
                        <TextBlock Text="绑定IP/主机名"
                                   VerticalAlignment="Center"
                                   Margin="0,0,4,8"
                                   ToolTip="要绑定的网络接口或主机名。使用0.0.0.0监听所有接口" />
                        <TextBox Width="150"
                                 Margin="0,0,12,8"
                                 ToolTip="要绑定的网络接口或主机名。使用0.0.0.0监听所有接口"
                                 IsEnabled="{Binding UiEnabled}"
                                 Text="{Binding BindAddress, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />

                        <!-- Port -->
                        <TextBlock Text="端口"
                                   ToolTip="监听的TCP端口。需要在路由器中转发该端口，或通过UPnP自动转发"
                                   VerticalAlignment="Center"
                                   Margin="0,0,4,8" />
                        <TextBox Width="80"
                                 Margin="0,0,12,8"
                                 ToolTip="监听的TCP端口。需要在路由器中转发该端口，或通过UPnP自动转发"
                                 IsEnabled="{Binding UiEnabled}"
                                 Text="{Binding Port, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />

                        <!-- Tick Rate -->
                        <TextBlock Text="更新频率(赫兹)"
                                   ToolTip="网页雷达数据的广播频率（每秒次数）"
                                   VerticalAlignment="Center"
                                   Margin="0,0,4,8" />
                        <TextBox Width="80"
                                 ToolTip="网页雷达数据的广播频率（每秒次数）"
                                 Margin="0,0,12,8"
                                 IsEnabled="{Binding UiEnabled}"
                                 Text="{Binding TickRate, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />

                        <!-- Password -->
                        <TextBlock Text="密码"
                                   VerticalAlignment="Center"
                                   ToolTip="客户端连接所需的密码"
                                   Margin="0,0,4,8" />
                        <TextBox Width="140"
                                 IsReadOnly="True"
                                 Margin="0,0,12,8"
                                 ToolTip="客户端连接所需的密码"
                                 IsEnabled="{Binding UiEnabled}"
                                 Text="{Binding Password, Mode=OneWay, UpdateSourceTrigger=Default}" />

                        <!-- URL (clickable + actions) -->
                        <TextBlock VerticalAlignment="Center"
                                   Margin="0,0,6,8">
                            <Hyperlink Command="{Binding CopyUrlCommand}"
                                       ToolTip="复制网页雷达URL到剪贴板">
                                <Run Text="{Binding ServerUrl}" />
                            </Hyperlink>
                        </TextBlock>
                    </WrapPanel>

                    <!-- Help text -->
                    <TextBlock TextWrapping="Wrap"
                               Margin="4,4,4,8">
                        若绑定IP/主机名为空，服务器将无法启动。使用0.0.0.0可向局域网开放。<LineBreak />
                        请确保路由器上开放了对应端口。UPnP将尝试自动创建路由器端口映射（如支持）。<LineBreak />
                        若好友通过HTTPS连接网页雷达，需在其浏览器中允许混合内容（HTTP/HTTPS）。建议仅使用HTTP连接。
                    </TextBlock>
                </StackPanel>
            </GroupBox>

        </StackPanel>
    </ScrollViewer>
</UserControl>