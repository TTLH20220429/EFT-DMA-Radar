<UserControl x:Class="LoneEftDmaRadar.UI.Radar.Views.RadarOverlay"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:vm="clr-namespace:LoneEftDmaRadar.UI.Radar.ViewModels"
             mc:Ignorable="d"
             d:DesignHeight="450"
             d:DesignWidth="800">

    <!-- 设计时视图模型关联 -->
    <d:UserControl.DataContext>
        <d:DesignInstance Type="{x:Type vm:RadarOverlayViewModel}"
                          IsDesignTimeCreatable="False" />
    </d:UserControl.DataContext>

    <UserControl.Resources>
        <!-- 可见性切换转换器 -->
        <BooleanToVisibilityConverter x:Key="BoolToVis" />
    </UserControl.Resources>

    <Grid>
        <!-- ─── 左上角工具栏 ─────────────────────────────────────────────── -->
        <StackPanel Orientation="Horizontal"
                    HorizontalAlignment="Left"
                    VerticalAlignment="Top"
                    Margin="8">
            <ToggleButton x:Name="MapFreeToggle"
                          Content="{Binding MapFreeButtonText}"
                          IsChecked="{Binding IsMapFreeEnabled}"
                          Padding="6,2"
                          Margin="0,0,4,0" />
            <ToggleButton x:Name="LootToggle"
                          Visibility="{Binding IsLootButtonVisible, Converter={StaticResource BoolToVis}}"
                          Content="战利品"
                          IsChecked="{Binding IsLootOverlayVisible}"
                          Padding="6,2" />
        </StackPanel>

        <!-- ─── 战利品覆盖层 ─────────────────────────────────────────── -->
        <Border Background="#DD1E1E1E"
                Padding="10"
                CornerRadius="4"
                MinWidth="300"
                MaxWidth="400"
                Visibility="{Binding IsLootOverlayVisible, Converter={StaticResource BoolToVis}}"
                Panel.ZIndex="50"
                HorizontalAlignment="Left"
                VerticalAlignment="Top"
                Margin="8,40,0,0">
            <StackPanel>
                <TextBlock Text="战利品"
                           Foreground="White"
                           FontWeight="Bold"
                           FontSize="14" />

                <TextBlock Text="按卢布价值筛选"
                           Foreground="White"
                           Margin="0,8,0,4" />

                <Grid Margin="0,0,0,8">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="2*" />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="2*" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>

                    <TextBlock Grid.Column="0"
                               Text="普通物品"
                               Foreground="White"
                               VerticalAlignment="Center" />
                    <TextBox Grid.Column="1"
                             Text="{Binding RegularValue, UpdateSourceTrigger=PropertyChanged}"
                             MinWidth="100" />
                    <TextBlock Grid.Column="2"
                               Text="贵重物品"
                               Foreground="White"
                               VerticalAlignment="Center"
                               Margin="12,0,0,0" />
                    <TextBox Grid.Column="3"
                             Text="{Binding ValuableValue, UpdateSourceTrigger=PropertyChanged}"
                             MinWidth="100" />
                    <CheckBox Grid.Column="4"
                              Content="每格价值"
                              IsChecked="{Binding PricePerSlot}"
                              Foreground="White"
                              Margin="12,0,0,0" />
                </Grid>

                <StackPanel Orientation="Horizontal"
                            Margin="0,0,0,8">
                    <RadioButton Content="跳蚤市场价格"
                                 ToolTip="使用跳蚤市场价格"
                                 IsChecked="{Binding IsFleaPrices, Mode=TwoWay}"
                                 GroupName="PriceSource"
                                 Foreground="White" />
                    <RadioButton Content="商人价格"
                                 ToolTip="使用商人回收价格"
                                 IsChecked="{Binding IsTraderPrices, Mode=TwoWay}"
                                 GroupName="PriceSource"
                                 Foreground="White"
                                 Margin="12,0,0,0" />
                </StackPanel>

                <WrapPanel Margin="0,0,0,8">
                    <CheckBox Content="隐藏尸体"
                              IsChecked="{Binding HideCorpses}"
                              Foreground="White"
                              Margin="0,0,12,0" />
                    <CheckBox Content="显示药品"
                              IsChecked="{Binding ShowMeds}"
                              Foreground="White"
                              Margin="0,0,12,0" />
                    <CheckBox Content="显示食物"
                              IsChecked="{Binding ShowFood}"
                              Foreground="White"
                              Margin="0,0,12,0" />
                    <CheckBox Content="显示背包"
                              IsChecked="{Binding ShowBackpacks}"
                              Foreground="White"
                              Margin="0,0,12,0" />
                    <CheckBox Content="显示任务物品"
                              IsChecked="{Binding ShowQuestItems}"
                              Foreground="White" />
                </WrapPanel>

                <TextBlock Text="战利品搜索（例：物品1,物品2,等）"
                           Foreground="White"
                           Margin="0,8,0,4" />
                <TextBox Text="{Binding SearchText, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, Delay=300}"
                         HorizontalAlignment="Stretch" />
            </StackPanel>
        </Border>
    </Grid>
</UserControl>